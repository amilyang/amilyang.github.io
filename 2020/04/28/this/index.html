<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>this | amilyang</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="this 是什么？this是什么？ 首先记住this不是指自身！ this就是一个指针， 指向调用函数的对象 this有哪些绑定规则？ 默认绑定 隐式绑定 硬绑定 new 绑定  默认绑定默认绑定，在不能应用其他绑定规则时使用默认规则。通常是独立函数调用。 function sauHi(){     console.log(&quot;Hello&quot;, this.name) } var n">
<meta property="og:type" content="article">
<meta property="og:title" content="this">
<meta property="og:url" content="http://yoursite.com/2020/04/28/this/index.html">
<meta property="og:site_name" content="amilyang">
<meta property="og:description" content="this 是什么？this是什么？ 首先记住this不是指自身！ this就是一个指针， 指向调用函数的对象 this有哪些绑定规则？ 默认绑定 隐式绑定 硬绑定 new 绑定  默认绑定默认绑定，在不能应用其他绑定规则时使用默认规则。通常是独立函数调用。 function sauHi(){     console.log(&quot;Hello&quot;, this.name) } var n">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-04-28T03:21:29.000Z">
<meta property="article:modified_time" content="2020-05-06T14:57:27.382Z">
<meta property="article:author" content="amilyang">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="amilyang" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">amilyang</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">经验在于总结</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-this" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/04/28/this/" class="article-date">
  <time datetime="2020-04-28T03:21:29.000Z" itemprop="datePublished">2020-04-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/javascript-%E5%8E%9F%E7%94%9F/">javascript 原生</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      this
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="this-是什么？"><a href="#this-是什么？" class="headerlink" title="this 是什么？"></a>this 是什么？</h2><p>this是什么？ 首先记住this不是指自身！ this就是一个指针， 指向调用函数的对象</p>
<h2 id="this有哪些绑定规则？"><a href="#this有哪些绑定规则？" class="headerlink" title="this有哪些绑定规则？"></a>this有哪些绑定规则？</h2><ul>
<li>默认绑定</li>
<li>隐式绑定</li>
<li>硬绑定</li>
<li>new 绑定</li>
</ul>
<h2 id="默认绑定"><a href="#默认绑定" class="headerlink" title="默认绑定"></a>默认绑定</h2><p>默认绑定，在不能应用其他绑定规则时使用默认规则。通常是独立函数调用。</p>
<pre><code>function sauHi(){
    console.log(&quot;Hello&quot;, this.name)
}
var name =&apos;ddssd&apos;
sayHi()</code></pre><p>在调用Hi（）时，应用了默认绑定，this指向全局对象（非严格模式下），严格模式下指向undefined， undefined上没有this 对象。会抛出错误。</p>
<p>上面的代码，如果在浏览器环境中运行，那么结果是 Hello ddssd</p>
<p>但如果在node环境中运行，结果就是Hello， undefined，这是因为node中name并不是挂在全局对象上的</p>
<h2 id="隐式绑定"><a href="#隐式绑定" class="headerlink" title="隐式绑定"></a>隐式绑定</h2><p>函数的调用在某个对象上触发的，即调用位置上存在上下文对象，典型的形式为 XXX.fun()。我们来看一段代码：</p>
<pre><code>function sayHi(){
  console.log(&apos;Hello,&apos;, this.name);
}
var person = {
  name: &apos;YvetteLau&apos;,
  sayHi: sayHi
}
var name = &apos;Wiliam&apos;;
person.sayHi();</code></pre><p>sayHi函数声明在外部，严格来说并不属于person，但是在调用sayHi时，调用位置会使用person的上下文来引用函数，隐式绑定会把函数调用中的this，（即此例sayH函数中的thisi）绑定到这个上下文对象（即此例中的person）</p>
<p>需要注意的是： 对象属性链中只有最后一层会影响到调用位置</p>
<pre><code>function sayHi(){
    console.log(&apos;Hello,&apos;, this.name);
}
var person2 = {
    name: &apos;Christina&apos;,
    sayHi: sayHi
}
var person1 = {
    name: &apos;YvetteLau&apos;,
    friend: person2
}
person1.friend.sayHi();</code></pre><p>结果是：Hello, Christina.</p>
<p>因为只有最后一层会确定this指向的是什么，不管有多少层，在判断this的时候，我们只关注最后一层，即此处的friend</p>
<p>隐式绑定有一个大陷阱，绑定很容易丢失（或者说容易给我们造成误导，我们以为this指向的是什么，但是实际上并非如此）</p>
<pre><code>function sayHi(){
    console.log(&apos;Hello,&apos;, this.name);
}
var person = {
    name: &apos;YvetteLau&apos;,
    sayHi: sayHi
}
var name = &apos;Wiliam&apos;;
var Hi = person.sayHi;
Hi();</code></pre><p>结果是: Hello,Wiliam.</p>
<p>这是为什么呢，Hi直接指向了sayHi的引用，在调用的时候，跟person没有半毛钱的关系，针对此类问题，我建议大家只需牢牢记住这个格式:XXX.fn(); fn()前如果什么都没有，那么肯定不是隐式绑定。</p>
<p>除了上面这种丢失之外，隐式绑定的丢失是发生在回调函数中(事件回调也是其中一种)，我们来看下面一个例子:</p>
<h2 id="绑定优先级"><a href="#绑定优先级" class="headerlink" title="绑定优先级"></a>绑定优先级</h2><p>我们知道了this有四种绑定规则，但是如果同时应用了多种规则，怎么办？<br>显然，我们需要了解哪一种绑定方式的优先级更高，这四种绑定的优先级为：</p>
<p>new 绑定 &gt; 显示绑定 &gt; 隐式绑定 &gt; 默认绑定</p>
<h2 id="绑定例外"><a href="#绑定例外" class="headerlink" title="绑定例外"></a>绑定例外</h2><p>凡事都有例外，this规则也是这样</p>
<p>如果我们将null或者undefined作为this的绑定对象传入call、apply或者是bind，这些值在调用的时候会被忽略，实际应用的是默认绑定规则</p>
<pre><code>var foo = {
  name: &apos;Selina&apos;
}
var name = &apos;Chirs&apos;;
function bar() {
  console.log(this.name);
}
bar.call(null); //Chirs </code></pre><p>在浏览器模式下输出了Chirs，因为这时实际应用的是默认绑定规则</p>
<h2 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h2><p>箭头函数是ES6中新增的，它和普通函数有一些区别，箭头函数没有自己的this，它的this继承于外层代码库中的this。 箭头函数在使用时，需要注意一下几点：</p>
<ol>
<li><p>函数体内的this，继承的是外层代码块的this</p>
</li>
<li><p>不可以当作构造函数，也就是说，不可以使用new 命令，否则会抛出一个错误</p>
</li>
<li><p>不可以使用arguments对象，该对象在函数体内不存在。如果要用，可以用rest参数代替。</p>
</li>
<li><p>不可以使用yield， 因此箭头函数不能用做Generator函数</p>
</li>
<li><p>箭头函数，没有自己的this，所以不能用call，apply，bind这些方法去改变this指向</p>
<pre><code>var obj = {
  hi: function() {
    console.log(this)
    return () =&gt; {
      console.log(this)
    }
  },
  sayHi: function(){
    return function(){
      console.log(this)
      return () =&gt; {
        console.log(this)
      }
    }
  },
  say: () =&gt; {
    console.log(this)
  }
}

let hi = obj.hi() //输出obj对象
hi() //输出obj对象
let sayHi = obj.sayHi() 
let fun1 = sayHi() //输出window
fun1() //输出window
obj.say() //输出window</code></pre></li>
</ol>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><h2 id="如何准确判断this指向的是什么？"><a href="#如何准确判断this指向的是什么？" class="headerlink" title="如何准确判断this指向的是什么？"></a>如何准确判断this指向的是什么？</h2><ol>
<li>函数是否咋new中调用（new绑定），如果是，那么this绑定的是新创建的对下岗</li>
<li>函数是否通过call、apply调用，或者使用bind（即硬绑定），如果是，那么this绑定的就是指定的对象</li>
<li>函数是否在某个上下文对象中调用（隐式绑定） ，如果是的话，thisa绑定的就是那个上下文对象，一般是obj.foo()</li>
<li>如果以上都不是，那么使用默认绑定，如果在严格模式下，则绑定到undefined，否则绑定到全局对象</li>
<li>如果把null或者undefined做为this的绑定对象传入call，apply， bind，这些值在调用时会被忽略，实际应用的是默认绑定规则</li>
<li>如果是箭头函数，箭头函数的this继承的是外层代码块的this。</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/04/28/this/" data-id="ck9vgtzaz0000p3wj2ll9eqne" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/04/29/EventEmitter/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          EventEmitter
        
      </div>
    </a>
  
  
    <a href="/2020/04/27/css/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">css</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/css/">css</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript-%E5%8E%9F%E7%94%9F/">javascript 原生</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%86%B7%E7%9F%A5%E8%AF%86/">冷知识</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8E%9F%E7%90%86%E6%8E%A2%E7%A9%B6/">原理探究</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">源码分析</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E9%9D%A2%E8%AF%95%E9%A2%98/">编程面试题</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/05/24/ionic%E5%85%A5%E9%97%A8/">ionic入门</a>
          </li>
        
          <li>
            <a href="/2020/05/06/%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84JSON%E6%A0%91%E7%BB%93%E6%9E%84%E7%9A%84%E8%BD%AC%E6%8D%A2/">一维数组JSON树结构的转换</a>
          </li>
        
          <li>
            <a href="/2020/04/29/Object-create-null/">Object.create(null)</a>
          </li>
        
          <li>
            <a href="/2020/04/29/EventEmitter/">EventEmitter</a>
          </li>
        
          <li>
            <a href="/2020/04/28/this/">this</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 amilyang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>